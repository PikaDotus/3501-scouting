<% provide(:title, "Team #{@team.number}") %>

<h1>Team <%= @team.number %></h1>

<div class="row">
	<div class="col-md-2"></div>
	<div class="col-md-6">
		<% if @matches.any? %>
			<h3>Matches (<%= @matches.count %>)</h3>
			<ol class="matches">
				<%= render @matches %>
			</ol>
		<% else %>
			<h3>No matches so far</h3>
		<% end %>
	</div>
	<div class="col-md-4">
		<%= pic_for @team %>
	</div>
</div>

<hr>
<br>

<% if @matches.any? %>
	<div class="row center">
		<div class="col-md-2">
			<% if @matches.average('top_made_auton') %>
				<h3> Top auton: <%= @matches.average('top_made_auton').round(1) %> </h3>
			<% end %>
		</div>
		<div class="col-md-2">
			<% if @matches.average('top_made_tele') %>
				<h3> Top tele: <%= @matches.average('top_made_tele').round(1) %> </h3>
			<% end %>
		</div>
		<div class="col-md-2">
			<% if @matches.where("speed > ?", 0).average('speed') %>
				<h3> Speed: <%= @matches.where("speed > ?", 0).average('speed').round(1) %> </h3>
			<% end %>
		</div>
		<div class="col-md-2">
			<% if @matches.where("moving_pickup > ?", 0).average('moving_pickup') %>
				<h3>Pickup speed: <%= @matches.where("moving_pickup > ?", 0).average('moving_pickup').round(1) %></h3>
			<% end %>
		</div>
		<div class="col-md-2">
			<% if @matches.where("driver_skill > ?", 0).average('driver_skill') %>
				<h3>Driver skill: <%= @matches.where("driver_skill > ?", 0).average('driver_skill').round(1) %></h3>
			<% end %>
		</div>
		<div class="col-md-2">
		</div>
	</div>

	<br>

	<div class="row">
		<div class="col-md-6">
			<h4>Auton scoring</h4>
			<%= area_chart [
			  {name: "Top made", data: @matches.map{|t| [t.match_number, t.top_made_auton] } },
			  {name: "Top missed", data: @matches.map{|t| [t.match_number, t.top_missed_auton] } } ],
			  height: '300px', stacked: true %>
		</div>
		<div class="col-md-6">
			<h4>Tele scoring</h4>
			<%= area_chart [
				{name: "Top made", data: @matches.map{|t| [t.match_number, t.top_made_tele] } },
				{name: "Top missed", data: @matches.map{|t| [t.match_number, t.top_missed_tele] } } ],
				height: '300px', stacked: true %>
		</div>
	</div>

	<br>

	<div class="row" style="margin-bottom:20px;">
		<div class="col-md-6">
			<h4>Truss scoring</h4>
			<%= area_chart [
				{name: "Truss made", data: @matches.map{|t| [t.match_number, t.truss_made] } },
				{name: "Truss missed", data: @matches.map{|t| [t.match_number, t.truss_missed] } } ],
				height: '300px', stacked: true %>
	</div>
	<div class="col-md-6">
		<h4>Receptions</h4>
		<%= area_chart [
				{name: "Receptions made", data: @matches.map{|t| [t.match_number, t.good_receptions] } },
				{name: "Receptions missed", data: @matches.map{|t| [t.match_number, t.attempted_receptions - t.good_receptions] } } ],
				height: '300px', stacked: true %>
	</div>
</div>

<div class="row" style="margin-bottom:90px;">
	<div class="col-md-1"></div>
	<div class="col-md-10">
		<% if @matches.any? %>
			<% @matches.each do |match| %>
				<% if match.notes.any? %>
					<%= render match.notes %>
				<% end %>
			<% end %>
		<% end %>
	</div>
	<div class="col-md-1"></div>
</div>

<% end %>
